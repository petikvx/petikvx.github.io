# Hydracrypt Ransomware

* [Packed Version at ANY.RUN](https://app.any.run/tasks/d233b1e6-5a71-4ff4-b07a-a537e58f9b1c)
* [Unpacked Version at ANY.RUN](https://app.any.run/tasks/d46b69f6-215d-4d04-845d-e208f7674864)

## Unpacking Malware

Here are the file's details :

```
petik@labvx:$ diec -d 446211d2ed10ab785a224abd5e731213af864064dd484cdb74fd5b3b8ebafd10
PE32
    Compiler: EP:Microsoft Visual C/C++(2017 v.15.5-6)[EXE32]
    Compiler: Microsoft Visual C/C++(19.36.32420)[C]
    Linker: Microsoft Linker(14.36.32537)
    Tool: Visual Studio(2022 version 17.6)

petik@labvx:$ diec -e 446211d2ed10ab785a224abd5e731213af864064dd484cdb74fd5b3b8ebafd10
Total 6.86336: packed
  0|PE Header|0|1024|2.65956: not packed
  1|Section(0)['.text']|1024|93184|6.53759: packed
  2|Section(1)['.rdata']|94208|31232|5.29386: not packed
  3|Section(2)['.data']|125440|23040|5.32351: not packed
  4|Section(3)['.reloc']|148480|6144|6.43714: not packed
  5|Section(4)['.kSvT']|154624|50001|5.96039: not packed

Size : 274K
```
To verify that the file is packed correctly, we will check it with x64dbg. To do this, we will set a breakpoint on the VirtualAlloc API.

![bp-virtualalloc](/images/hydracrypt/bp-virtualalloc.png)

We run the program until it stops at the first breakpoint.

![first-bp-alloc](/images/hydracrypt/first-bp-alloc.png)

We will go back to the CPU section and then proceed step by step using the F8 key.

